<app-header 
  [pageTitle]="'بيانات الطرق المحيطة'"
  [showBackButton]="true"
  [showHomeButton]="true"
  (backClicked)="navigateBack()"
  (homeClicked)="goHome()"
  (logoutClicked)="logout()"
></app-header>

<div class="container">
  <div class="page-content">
    <h1>بيانات الطرق المحيطة</h1>
    <p class="subtitle">أدخل بيانات الطرق المحيطة بالمبنى</p>

    <!-- Roads Form -->
    <div class="form-wrapper">
      <form [formGroup]="roadsForm" (ngSubmit)="onSubmit()">
        <div class="form-section">
          <h3 class="section-title">بيانات المبنى والموقع</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="buildingCode">كود المبنى <span class="required">*</span></label>
              <input 
                type="text" 
                id="buildingCode" 
                formControlName="buildingCode"
                placeholder="أدخل كود المبنى"
                [class.error]="roadsForm.get('buildingCode')?.invalid && roadsForm.get('buildingCode')?.touched"
              />
              @if (roadsForm.get('buildingCode')?.invalid && roadsForm.get('buildingCode')?.touched) {
                <span class="error-message">كود المبنى مطلوب</span>
              }
            </div>

            <div class="form-group">
              <label for="centerCode">كود المركز <span class="required">*</span></label>
              <input 
                type="text" 
                id="centerCode" 
                formControlName="centerCode"
                placeholder="أدخل كود المركز"
                [class.error]="roadsForm.get('centerCode')?.invalid && roadsForm.get('centerCode')?.touched"
              />
              @if (roadsForm.get('centerCode')?.invalid && roadsForm.get('centerCode')?.touched) {
                <span class="error-message">كود المركز مطلوب</span>
              }
            </div>

            <div class="form-group">
              <label for="branchCode">كود الفرع <span class="required">*</span></label>
              <input 
                type="text" 
                id="branchCode" 
                formControlName="branchCode"
                placeholder="أدخل كود الفرع"
                [class.error]="roadsForm.get('branchCode')?.invalid && roadsForm.get('branchCode')?.touched"
              />
              @if (roadsForm.get('branchCode')?.invalid && roadsForm.get('branchCode')?.touched) {
                <span class="error-message">كود الفرع مطلوب</span>
              }
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">بيانات الطريق</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="mainRoadTypeCode">كود نوع الطريق الرئيسي <span class="required">*</span></label>
              <div class="code-with-name">
                <select 
                  id="mainRoadTypeCode" 
                  formControlName="mainRoadTypeCode"
                  [class.error]="roadsForm.get('mainRoadTypeCode')?.invalid && roadsForm.get('mainRoadTypeCode')?.touched"
                >
                  <option value="" disabled>اختر نوع الطريق</option>
                  @for (type of mainRoadTypes; track type.code) {
                    <option [value]="type.code">{{ type.code }} - {{ type.name }}</option>
                  }
                </select>
                @if (roadsForm.get('mainRoadTypeCode')?.value) {
                  <span class="selected-name">{{ getMainRoadTypeName(roadsForm.get('mainRoadTypeCode')?.value) }}</span>
                }
              </div>
              @if (roadsForm.get('mainRoadTypeCode')?.invalid && roadsForm.get('mainRoadTypeCode')?.touched) {
                <span class="error-message">كود نوع الطريق الرئيسي مطلوب</span>
              }
            </div>

            <div class="form-group">
              <label for="roadWidth">عرض الطريق (متر) <span class="required">*</span></label>
              <input 
                type="number" 
                id="roadWidth" 
                formControlName="roadWidth"
                placeholder="أدخل عرض الطريق"
                min="0"
                step="0.1"
                [class.error]="roadsForm.get('roadWidth')?.invalid && roadsForm.get('roadWidth')?.touched"
              />
              @if (roadsForm.get('roadWidth')?.invalid && roadsForm.get('roadWidth')?.touched) {
                <span class="error-message">عرض الطريق مطلوب</span>
              }
            </div>

            <div class="form-group">
              <label for="movementDirectionCode">كود اتجاه الحركة <span class="required">*</span></label>
              <div class="code-with-name">
                <select 
                  id="movementDirectionCode" 
                  formControlName="movementDirectionCode"
                  [class.error]="roadsForm.get('movementDirectionCode')?.invalid && roadsForm.get('movementDirectionCode')?.touched"
                >
                  <option value="" disabled>اختر اتجاه الحركة</option>
                  @for (direction of movementDirections; track direction.code) {
                    <option [value]="direction.code">{{ direction.code }} - {{ direction.name }}</option>
                  }
                </select>
                @if (roadsForm.get('movementDirectionCode')?.value) {
                  <span class="selected-name">{{ getMovementDirectionName(roadsForm.get('movementDirectionCode')?.value) }}</span>
                }
              </div>
              @if (roadsForm.get('movementDirectionCode')?.invalid && roadsForm.get('movementDirectionCode')?.touched) {
                <span class="error-message">كود اتجاه الحركة مطلوب</span>
              }
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">
            <span>💾</span>
            حفظ البيانات
          </button>
          <button type="button" class="btn btn-secondary" (click)="onReset()">
            <span>🔄</span>
            إعادة تعيين
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
